<html><head></head><body><div hidden="" by-polymer-bundler=""><script>'use strict';Polymer({is:'iron-request',hostAttributes:{hidden:!0},properties:{xhr:{type:Object,notify:!0,readOnly:!0,value:function(){return new XMLHttpRequest}},response:{type:Object,notify:!0,readOnly:!0,value:function(){return null}},status:{type:Number,notify:!0,readOnly:!0,value:0},statusText:{type:String,notify:!0,readOnly:!0,value:''},completes:{type:Object,readOnly:!0,notify:!0,value:function(){return new Promise(function(a,b){this.resolveCompletes=a,this.rejectCompletes=b}.bind(this))}},progress:{type:Object,notify:!0,readOnly:!0,value:function(){return{}}},aborted:{type:Boolean,notify:!0,readOnly:!0,value:!1},errored:{type:Boolean,notify:!0,readOnly:!0,value:!1},timedOut:{type:Boolean,notify:!0,readOnly:!0,value:!1}},get succeeded(){if(this.errored||this.aborted||this.timedOut)return!1;var a=this.xhr.status||0;return 0===a||200<=a&&300>a},send:function(a){var b=this.xhr;if(0<b.readyState)return null;b.addEventListener('progress',function(a){this._setProgress({lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total})}.bind(this)),b.addEventListener('error',function(b){this._setErrored(!0),this._updateStatus();var c=a.rejectWithRequest?{error:b,request:this}:b;this.rejectCompletes(c)}.bind(this)),b.addEventListener('timeout',function(b){this._setTimedOut(!0),this._updateStatus();var c=a.rejectWithRequest?{error:b,request:this}:b;this.rejectCompletes(c)}.bind(this)),b.addEventListener('abort',function(){this._setAborted(!0),this._updateStatus();var b=new Error('Request aborted.'),c=a.rejectWithRequest?{error:b,request:this}:b;this.rejectCompletes(c)}.bind(this)),b.addEventListener('loadend',function(){if(this._updateStatus(),this._setResponse(this.parseResponse()),!this.succeeded){var b=new Error('The request failed with status code: '+this.xhr.status),c=a.rejectWithRequest?{error:b,request:this}:b;return void this.rejectCompletes(c)}this.resolveCompletes(this)}.bind(this)),this.url=a.url,b.open(a.method||'GET',a.url,!1!==a.async);var c={json:'application/json',text:'text/plain',html:'text/html',xml:'application/xml',arraybuffer:'application/octet-stream'}[a.handleAs],d=a.headers||Object.create(null),e=Object.create(null);for(var f in d)e[f.toLowerCase()]=d[f];if(d=e,c&&!d.accept&&(d.accept=c),Object.keys(d).forEach(function(a){/[A-Z]/.test(a)&&Polymer.Base._error('Headers must be lower case, got',a),b.setRequestHeader(a,d[a])},this),!1!==a.async){a.async&&(b.timeout=a.timeout);var g=a.handleAs;!a.jsonPrefix&&g||(g='text'),b.responseType=b._responseType=g,!a.jsonPrefix||(b._jsonPrefix=a.jsonPrefix)}b.withCredentials=!!a.withCredentials;var h=this._encodeBodyObject(a.body,d['content-type']);return b.send(h),this.completes},parseResponse:function(){var a=this.xhr,b=a.responseType||a._responseType,c=!this.xhr.responseType,d=a._jsonPrefix&&a._jsonPrefix.length||0;try{switch(b){case'json':if(c||a.response===void 0)try{return JSON.parse(a.responseText)}catch(a){return null}return a.response;case'xml':return a.responseXML;case'blob':case'document':case'arraybuffer':return a.response;case'text':default:{if(d)try{return JSON.parse(a.responseText.substring(d))}catch(a){return null}return a.responseText}}}catch(a){this.rejectCompletes(new Error('Could not parse response. '+a.message))}},abort:function(){this._setAborted(!0),this.xhr.abort()},_encodeBodyObject:function(a,b){if('string'==typeof a)return a;var c=a;return'application/json'===b?JSON.stringify(c):'application/x-www-form-urlencoded'===b?this._wwwFormUrlEncode(c):a},_wwwFormUrlEncode:function(a){if(!a)return'';var b=[];return Object.keys(a).forEach(function(c){b.push(this._wwwFormUrlEncodePiece(c)+'='+this._wwwFormUrlEncodePiece(a[c]))},this),b.join('&')},_wwwFormUrlEncodePiece:function(a){return null!==a&&void 0!==a&&a.toString?encodeURIComponent(a.toString().replace(/\r?\n/g,'\r\n')).replace(/%20/g,'+'):''},_updateStatus:function(){this._setStatus(this.xhr.status),this._setStatusText(this.xhr.statusText===void 0?'':this.xhr.statusText)}});</script><script>'use strict';Polymer({is:'iron-ajax',hostAttributes:{hidden:!0},properties:{url:{type:String},params:{type:Object,value:function(){return{}}},method:{type:String,value:'GET'},headers:{type:Object,value:function(){return{}}},contentType:{type:String,value:null},body:{type:Object,value:null},sync:{type:Boolean,value:!1},handleAs:{type:String,value:'json'},withCredentials:{type:Boolean,value:!1},timeout:{type:Number,value:0},auto:{type:Boolean,value:!1},verbose:{type:Boolean,value:!1},lastRequest:{type:Object,notify:!0,readOnly:!0},loading:{type:Boolean,notify:!0,readOnly:!0},lastResponse:{type:Object,notify:!0,readOnly:!0},lastError:{type:Object,notify:!0,readOnly:!0},activeRequests:{type:Array,notify:!0,readOnly:!0,value:function(){return[]}},debounceDuration:{type:Number,value:0,notify:!0},jsonPrefix:{type:String,value:''},bubbles:{type:Boolean,value:!1},rejectWithRequest:{type:Boolean,value:!1},_boundHandleResponse:{type:Function,value:function(){return this._handleResponse.bind(this)}}},observers:['_requestOptionsChanged(url, method, params.*, headers, contentType, body, sync, handleAs, jsonPrefix, withCredentials, timeout, auto)'],get queryString(){var a,b,c=[];for(a in this.params)if(b=this.params[a],a=window.encodeURIComponent(a),Array.isArray(b))for(var d=0;d<b.length;d++)c.push(a+'='+window.encodeURIComponent(b[d]));else null===b?c.push(a):c.push(a+'='+window.encodeURIComponent(b));return c.join('&')},get requestUrl(){var a=this.queryString,b=this.url||'';if(a){var c=0<=b.indexOf('?')?'&':'?';return b+c+a}return b},get requestHeaders(){var a={},b=this.contentType;null==b&&'string'===typeof this.body&&(b='application/x-www-form-urlencoded'),b&&(a['content-type']=b);if('object'===babelHelpers.typeof(this.headers))for(var c in this.headers)a[c]=this.headers[c].toString();return a},toRequestOptions:function(){return{url:this.requestUrl||'',method:this.method,headers:this.requestHeaders,body:this.body,async:!this.sync,handleAs:this.handleAs,jsonPrefix:this.jsonPrefix,withCredentials:this.withCredentials,timeout:this.timeout,rejectWithRequest:this.rejectWithRequest}},generateRequest:function(){var a=document.createElement('iron-request'),b=this.toRequestOptions();this.push('activeRequests',a),a.completes.then(this._boundHandleResponse).catch(this._handleError.bind(this,a)).then(this._discardRequest.bind(this,a));var c=this.fire('iron-ajax-presend',{request:a,options:b},{bubbles:this.bubbles,cancelable:!0});return c.defaultPrevented?(a.abort(),a.rejectCompletes(a),a):(a.send(b),this._setLastRequest(a),this._setLoading(!0),this.fire('request',{request:a,options:b},{bubbles:this.bubbles,composed:!0}),this.fire('iron-ajax-request',{request:a,options:b},{bubbles:this.bubbles,composed:!0}),a)},_handleResponse:function(a){a===this.lastRequest&&(this._setLastResponse(a.response),this._setLastError(null),this._setLoading(!1)),this.fire('response',a,{bubbles:this.bubbles,composed:!0}),this.fire('iron-ajax-response',a,{bubbles:this.bubbles,composed:!0})},_handleError:function(a,b){this.verbose&&Polymer.Base._error(b),a===this.lastRequest&&(this._setLastError({request:a,error:b,status:a.xhr.status,statusText:a.xhr.statusText,response:a.xhr.response}),this._setLastResponse(null),this._setLoading(!1)),this.fire('iron-ajax-error',{request:a,error:b},{bubbles:this.bubbles,composed:!0}),this.fire('error',{request:a,error:b},{bubbles:this.bubbles,composed:!0})},_discardRequest:function(a){var b=this.activeRequests.indexOf(a);-1<b&&this.splice('activeRequests',b,1)},_requestOptionsChanged:function(){this.debounce('generate-request',function(){null==this.url||this.auto&&this.generateRequest()},this.debounceDuration)}});</script></div><dom-module id="bank-login-service"><template><iron-ajax id="loginRequest" handle-as="json" content-type="application/json" on-response="_handleResponse" on-error="_handleError"></iron-ajax></template><script>Polymer({is:'bank-login-service',properties:{user:String,password:String,baseUrl:{type:String,value:function(){return'https://banq.qafe.com/rest/v0'}}},_handleResponse:function(a){a.detail.__data.response.token&&this.fire('token-valid',a.detail.__data.response.token)},_handleError:function(a){debugger;this.fire('token-valid','asdasdasdasdasd'),a&&('403'==a.detail.request.__data.status?this.fire('message',a.detail.request.__data.response):'400'==a.detail.request.__data.status?this.fire('message','You have to fill this fields caralho.'):this.fire('token-invalid',a.response))},generateGetRequest:function(){var a={};a.emailaddress=this.user,a.password=this.password,this.$.loginRequest.method='POST',this.$.loginRequest.headers={},this.$.loginRequest.body=a,this.$.loginRequest.url=this.baseUrl+'/login',this.$.loginRequest.generateRequest()}});</script></dom-module></body></html>